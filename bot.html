<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Advanced Bot Check</title>
  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }
    .card {
      background: #222;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 20px #000;
      text-align: center;
      max-width: 400px;
    }
    button {
      padding: 10px 20px;
      background: #0f62fe;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      margin-top: 15px;
    }
    #task {
      margin-top: 15px;
      display: none;
    }
    #likeRequest {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 99;
      flex-direction: column;
    }
    .captcha-check {
      display: none;
      margin-top: 15px;
      text-align: left;
    }
  </style>
</head>
<body>

<div class="card">
  <h2>Robot Verification</h2>
  <p>Click the button below to verify you're human.</p>
  <button onclick="checkBot()">Click to prove you're not a robot</button>
  <div id="result"></div>
  <div id="task">
    <div class="captcha-check">
      <input type="checkbox" id="captchaCheckbox"> I am human
    </div>
    <button onclick="validateTask()" id="submitTask" style="display:none;">Submit</button>
  </div>
</div>

<script>
  function hideLike() {
    document.getElementById('likeRequest').style.display = 'none';
  }

  async function getIPInfo() {
    const response = await fetch('https://ipapi.co/json/');
    const data = await response.json();
    return data;
  }

  function checkBot() {
    const suspicious = [];

    // Get user data
    const ua = navigator.userAgent;
    const lang = navigator.language;
    const platform = navigator.platform;
    const memory = navigator.deviceMemory || 0;
    const cores = navigator.hardwareConcurrency || 0;
    const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
    const hasTouch = 'ontouchstart' in window;
    const plugins = navigator.plugins.length;

    // Get IP Info (API request)
    getIPInfo().then((ipInfo) => {
      const ip = ipInfo.ip;
      const city = ipInfo.city;
      const country = ipInfo.country_name;
      const isp = ipInfo.org;
      const location = `${city}, ${country}`;

      // Check if the user is using a VPN, datacenter, or proxy
      if (isp.includes("Amazon") || isp.includes("Google") || isp.includes("OVH")) {
        suspicious.push('VPN or cloud service detected (ISP: ' + isp + ')');
      }

      // Device + Browser Checks
      if (/HeadlessChrome/.test(ua)) suspicious.push('Headless browser detected');
      if (!lang) suspicious.push('Missing language');
      if (!platform || platform === 'Win32' && cores === 0) suspicious.push('Suspicious platform or CPU');
      if (memory < 1) suspicious.push('No memory reported');
      if (cores < 1) suspicious.push('No CPU cores detected');
      if (!timezone) suspicious.push('Timezone missing');
      if (plugins === 0) suspicious.push('No plugins detected');

      // WebGL Vendor Check
      const gl = document.createElement('canvas').getContext('webgl');
      let glVendor = '', glRenderer = '';
      if (gl) {
        const dbg = gl.getExtension('WEBGL_debug_renderer_info');
        if (dbg) {
          glVendor = gl.getParameter(dbg.UNMASKED_VENDOR_WEBGL);
          glRenderer = gl.getParameter(dbg.UNMASKED_RENDERER_WEBGL);
          if (/swiftshader|llvmpipe/i.test(glRenderer)) suspicious.push('Software rendering detected');
        }
      }

      // Check if Adblock is running by testing visible content
      const adTest = document.createElement('div');
      adTest.innerHTML = '&nbsp;';
      adTest.className = 'adsbox';
      document.body.appendChild(adTest);
      window.setTimeout(() => {
        if (adTest.offsetHeight === 0) suspicious.push('Ad blocker detected');
        adTest.remove();

        showResult(suspicious, location, ip);
      }, 100);
    });
  }

  function showResult(suspicious, location, ip) {
    const result = document.getElementById('result');
    const task = document.getElementById('task');
    const captchaCheck = document.querySelector('.captcha-check');
    const submitTask = document.getElementById('submitTask');

    if (suspicious.length === 0) {
      result.innerHTML = `<p style='color:lime'>✅ You're verified as human! (IP: ${ip}, Location: ${location})</p>`;
      task.innerHTML = '';
      captchaCheck.style.display = 'none';
      submitTask.style.display = 'none';
    } else {
      result.innerHTML = `<p style='color:orange'>⚠️ Suspicious traits detected:</p><ul>${suspicious.map(s => `<li>${s}</li>`).join('')}</ul>`;
      
      // Trigger checkbox CAPTCHA task
      task.innerHTML = '<p>To continue, please verify you are human by checking the box below:</p>';
      captchaCheck.style.display = 'block';
      submitTask.style.display = 'inline-block';
    }
  }

  function validateTask() {
    const captchaCheckbox = document.getElementById('captchaCheckbox');
    const submitTask = document.getElementById('submitTask');

    if (captchaCheckbox.checked) {
      submitTask.innerHTML = '<p style="color:lime;">✅ Task complete. You may continue.</p>';
      submitTask.disabled = true;
    } else {
      submitTask.innerHTML = '<p style="color:red;">❌ Please check the box to continue.</p>';
    }
  }
</script>

</body>
</html>
